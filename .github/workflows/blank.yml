name: Telegram Quit Smoking Reminder

on:
  schedule:
    # Times are in UTC.
    # 7,10,14,17,20 UTC â‰ˆ 8,11,15,18,21 in Europe/Amsterdam
    - cron: "0 7 * * *"
    - cron: "0 10 * * *"
    - cron: "0 14 * * *"
    - cron: "0 17 * * *"
    - cron: "0 20 * * *"

jobs:
  send-message:
    runs-on: ubuntu-latest
    steps:
      - name: Choose message based on time
        id: choose
        run: |
          HOUR=$(date -u +%H)

          if [ "$HOUR" = "07" ]; then
            MSG="×‘×•×§×¨ ×˜×•×‘ ××ž×™×¨ â˜€ï¸ ×›×œ ×¡×™×’×¨×™×” ×©×œ× ×¢×™×©× ×ª ×”×™×•× ×”×™× × ×™×¦×—×•×Ÿ ×§×˜×Ÿ. ×ª×ª×—×™×œ ××ª ×”×™×•× × ×§×™ ×•×—×–×§."
          elif [ "$HOUR" = "10" ]; then
            MSG="××ž×¦×¢ ×”×‘×•×§×¨ ðŸ’ª ×›×‘×¨ ×©×¨×“×ª ××ª ×”×§×¨×™×™×‘×™× ×’ ×©×œ ×”×‘×•×§×¨. ××ª×” ×œ× ×¦×¨×™×š ×¡×™×’×¨×™×” ×›×“×™ ×œ×”×ª×¨×›×– â€“ ×–×” ×¨×§ ××•×˜×•×ž×˜ ×™×©×Ÿ."
          elif [ "$HOUR" = "14" ]; then
            MSG="×¦×”×¨×™×™× ðŸŒ¤ï¸ ×–×” ×”×¨×’×¢ ×©×œ \"×¡×™×’×¨×™×” ××—×¨×™ ×”××•×›×œ\" â€“ ××‘×œ ××ª×” ×‘×•× ×” ×œ×¢×¦×ž×š ×”×¨×’×œ ×—×“×©. ×ž×™× + ×ª×–×•×–×” ×“×§×” ××—×ª ×‘×ž×§×•×, ×•××ª×” ×ž× ×¦×—."
          elif [ "$HOUR" = "17" ]; then
            MSG="××—×¨ ×”×¦×”×¨×™×™× ðŸ§  ×”×¢×™×™×¤×•×ª ×ž×‘×§×©×ª ×”×¨×’×œ ×™×©×Ÿ, ×œ× × ×™×§×•×˜×™×Ÿ. × ×©×™×ž×” ×¢×ž×•×§×”, ×ž×™×, ×©×ª×™ ×“×§×•×ª ×–×– â€“ ×•××ª×” ×ž×•×›×™×— ×œ×¢×¦×ž×š ×ž×™ ×©×•×œ×˜ ×¤×”."
          elif [ "$HOUR" = "20" ]; then
            MSG="×¢×¨×‘ ×˜×•×‘ ðŸŒ™ ×¢×•×“ ×™×•× ×‘×œ×™ ×¡×™×’×¨×™×•×ª ×ž××—×•×¨×™×š. ×ª×Ÿ ×œ×¢×¦×ž×š ×§×¨×“×™×˜ â€“ ×›×œ ×™×•× ×›×–×” ×ž×§×¦×¨ ××ª ×”×“×¨×š ×œ×’×¨×¡×” ×”×¨×‘×” ×™×•×ª×¨ ×‘×¨×™××” ×©×œ×š."
          else
            # fallback, shouldn't really happen but just in case
            MSG="×ª×–×›×•×¨×ª âœ¨ ××ª×” ×œ× ×ž×¢×©×Ÿ. ×–×” ×¨×§ ×”×¨×’×œ ×™×©×Ÿ ×©×ž× ×¡×” ×œ×—×–×•×¨ â€“ ×•××ª×” ×©×•×œ×˜ ×‘×•, ×œ× ×œ×”×¤×š."
          fi

          echo "msg=$MSG" >> "$GITHUB_OUTPUT"

      - name: Send Telegram Message
        run: |
          curl -s -X POST "https://api.telegram.org/bot${{ secrets.BOT_TOKEN }}/sendMessage" \
            -d chat_id="${{ secrets.CHAT_ID }}" \
            --data-urlencode "text=${{ steps.choose.outputs.msg }}"
